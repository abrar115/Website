<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Your custom CSS -->
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="weird.css">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet">

  <!-- FontAwesome CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-gEXAMPLE" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <link rel="icon" href="images/calendar-days-solid.svg" type="image/x-icon">

  <title>Timesheet</title>
  <style>
    /* Prevent editable cells from changing background */
    #timesheetTable td[contenteditable="true"] {
      background: inherit;
      outline: none;
      color: inherit;
    }
  </style>
</head>
<body class="timesheet__body">

<nav class="sidenav sidenav__details">
  <h2>Study</h2>
  <ul>
    <li><a href="index.html"><i class="fa-solid fa-bomb"></i> Home</a></li>
    <li><a href="chemistry.html"><i class="fa-solid fa-flask-vial"></i> Chemistry</a></li>
    <li><a href="computer.html"><i class="fa-solid fa-globe"></i> Cs</a></li>
    <li><a href="math.html"><i class="fa-solid fa-calculator"></i> Math</a></li>
    <li><a href="physics.html"><i class="fa-solid fa-gun"></i> Physics</a></li>
    <li><a href="study.html"><i class="fa-solid fa-backward"></i> Go back</a></li>
  </ul>
</nav>

<main>
  <div class="menu">
    <img src="https://arsentech.github.io/source-codes/icons/menu.svg" alt="menu" width="36" height="36" id="menu">
  </div> 
  <div class="cursor"></div>

  <div class="timesheet__main">
    <div class="timesheet__containers">
      <!-- Password unlock -->
      <div style="text-align:center; margin-bottom:15px;">
        <input type="password" id="authPassword" placeholder="Enter password">
        <button id="unlockBtn">Unlock</button>
        <span id="authMsg" style="color:red; font-size:0.9em;"></span>
      </div>

      <!-- Timesheet table -->
      <table class="timesheet__table" id="timesheetTable">
        <thead>
          <tr>
            <th>Day</th>
            <th>Physics</th>
            <th>Chemistry</th>
            <th>Math</th>
            <th>CS</th>
            <th>Research</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Sunday</td><td></td><td></td><td></td><td></td><td></td></tr>
          <tr><td>Monday</td><td></td><td></td><td></td><td></td><td></td></tr>
          <tr><td>Tuesday</td><td></td><td></td><td></td><td></td><td></td></tr>
          <tr><td>Wednesday</td><td></td><td></td><td></td><td></td><td></td></tr>
          <tr><td>Thursday</td><td></td><td></td><td></td><td></td><td></td></tr>
          <tr class="totals-row">
            <td><strong>Total</strong></td>
            <td id="total-physics">0</td>
            <td id="total-chemistry">0</td>
            <td id="total-math">0</td>
            <td id="total-cs">0</td>
            <td id="total-research">0</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</main>

<!-- JS -->
<script>
const table = document.getElementById("timesheetTable");
const PASSWORD = "study123";

// Save table data to localStorage
function saveData() {
  const rows = table.querySelectorAll("tbody tr:not(.totals-row)");
  const data = Array.from(rows).map(row => {
    return Array.from(row.querySelectorAll("td")).slice(1).map(cell => cell.innerText.trim());
  });
  localStorage.setItem("timesheetData", JSON.stringify(data));
}


function loadData() {
  const saved = localStorage.getItem("timesheetData");
  if (!saved) return;
  const data = JSON.parse(saved);
  const rows = table.querySelectorAll("tbody tr:not(.totals-row)");
  rows.forEach((row, rIndex) => {
    const cells = row.querySelectorAll("td");
    for (let c = 1; c < cells.length; c++) {
      cells[c].innerText = data[rIndex]?.[c-1] || "";
    }
  });
}

// Calculate totals
function calculateTotals() {
  const rows = table.querySelectorAll("tbody tr:not(.totals-row)");
  const totals = [0,0,0,0,0];
  rows.forEach(row => {
    const cells = row.querySelectorAll("td");
    for (let i=1;i<cells.length;i++){
      totals[i-1] += parseFloat(cells[i].innerText) || 0;
    }
  });
  ["physics","chemistry","math","cs","research"].forEach((subj,i) => {
    document.getElementById("total-"+subj).innerText = totals[i];
  });
}

// Disable editing by default
document.querySelectorAll("#timesheetTable td:not(:first-child)").forEach(cell => {
  cell.setAttribute("contenteditable","false");
});

// Unlock button
document.getElementById("unlockBtn").addEventListener("click", () => {
  const entered = document.getElementById("authPassword").value;
  const msg = document.getElementById("authMsg");
  if (entered === PASSWORD) {
    const cells = document.querySelectorAll("#timesheetTable td:not(:first-child)");
    cells.forEach(cell => {
      cell.setAttribute("contenteditable","true");
      // attach event listener for saving & totals
      cell.addEventListener("input", () => {
        saveData();
        calculateTotals();
      });
    });
    msg.style.color = "green";
    msg.textContent = "Unlocked!";
  } else {
    msg.style.color = "red";
    msg.textContent = "Wrong password!";
  }
});

// Init
loadData();
calculateTotals();
</script>

</body>
</html>
