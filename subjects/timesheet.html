<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../weird.css">
  <link rel="stylesheet" href="../styles.css">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../fontawesome/css/all.css">
  <link rel="icon" href="../images/calendar-days-solid.svg" type="image/x-icon">
  <title>Timesheet</title>
</head>
<body class="timesheet__body">
  <nav class="sidenav sidenav__details">
    <h2>Study</h2>
    <ul>
      <li><a href="../index.html"><i class="fa-solid fa-bomb"></i> Home</a></li>
      <li><a href="chemistry.html"><i class="fa-solid fa-flask-vial"></i> Chemistry</a></li>
      <li><a href="computer.html"><i class="fa-solid fa-globe"></i> Cs</a></li>
      <li><a href="math.html"><i class="fa-solid fa-calculator"></i> Math</a></li>
      <li><a href="physics.html"><i class="fa-solid fa-gun"></i> Physics</a></li>
      <li><a href="../study.html"><i class="fa-solid fa-backward"></i> Go back</a></li>
    </ul>
  </nav>

  <main> 
    <div class="menu">
      <img src="https://arsentech.github.io/source-codes/icons/menu.svg" alt="menu" width="36" height="36" id="menu">
    </div> 
    <div class="cursor"></div>

    <div class="timesheet__main">
      <div class="timesheet__containers">
          <div style="text-align:center; margin-bottom:15px;">
    <input type="password" id="authPassword" placeholder="Enter password">
    <button id="unlockBtn">Unlock</button>
    <span id="authMsg" style="color:red; font-size:0.9em;"></span>
  </div>
        <table class="timesheet__table" id="timesheetTable">
          <thead>
            <tr>
              <th>Day</th>
              <th>Physics</th>
              <th>Chemistry</th>
              <th>Math</th>
              <th>CS</th>
              <th>Research</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Sunday</td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
            </tr>
            <tr>
              <td>Monday</td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
            </tr>
            <tr>
              <td>Tuesday</td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
            </tr>
            <tr>
              <td>Wednesday</td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
            </tr>
            <tr>
              <td>Thursday</td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
              <td contenteditable="true"></td>
            </tr>
            <tr class="totals-row">
              <td><strong>Total</strong></td>
              <td id="total-physics">0</td>
              <td id="total-chemistry">0</td>
              <td id="total-math">0</td>
              <td id="total-cs">0</td>
              <td id="total-research">0</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </main>

  <script src="../jsfiles/new.js"></script>
  <script>
      const table = document.getElementById("timesheetTable");

  
  function saveData() {
    const rows = table.querySelectorAll("tbody tr:not(.totals-row)");
    let data = [];

    rows.forEach(row => {
      let rowData = [];
      const cells = row.querySelectorAll("td");
      for (let i = 1; i < cells.length; i++) { 
        rowData.push(cells[i].innerText.trim());
      }
      data.push(rowData);
    });

    localStorage.setItem("timesheetData", JSON.stringify(data));
  }
const PASSWORD = "study123";

// Disable editing by default
document.querySelectorAll("#timesheetTable td:not(:first-child)").forEach(cell => {
  cell.setAttribute("contenteditable", "false");
});

document.getElementById("unlockBtn").addEventListener("click", () => {
  const entered = document.getElementById("authPassword").value;
  const msg = document.getElementById("authMsg");

  if (entered === PASSWORD) {
    const cells = document.querySelectorAll("#timesheetTable td:not(:first-child)");
    cells.forEach(cell => {
      cell.setAttribute("contenteditable", "true");

      // Add the input listener now
      cell.addEventListener("input", () => {
        saveData();
        calculateTotals();
      });
    });

    msg.style.color = "green";
    msg.textContent = "Unlocked!";
  } else {
    msg.style.color = "red";
    msg.textContent = "Wrong password!";
  }
});

  function loadData() {
    let saved = localStorage.getItem("timesheetData");
    if (saved) {
      let data = JSON.parse(saved);
      const rows = table.querySelectorAll("tbody tr:not(.totals-row)");
      rows.forEach((row, rIndex) => {
        const cells = row.querySelectorAll("td");
        for (let c = 1; c < cells.length; c++) {
          cells[c].innerText = data[rIndex][c-1] || "";
        }
      });
    }
  }


  function calculateTotals() {
    const rows = table.querySelectorAll("tbody tr:not(.totals-row)");
    let totals = [0, 0, 0, 0, 0]; 

    rows.forEach(row => {
      const cells = row.querySelectorAll("td");
      for (let i = 1; i < cells.length; i++) {
        let val = parseFloat(cells[i].innerText) || 0;
        totals[i-1] += val;
      }
    });

    document.getElementById("total-physics").innerText = totals[0];
    document.getElementById("total-chemistry").innerText = totals[1];
    document.getElementById("total-math").innerText = totals[2];
    document.getElementById("total-cs").innerText = totals[3];
    document.getElementById("total-research").innerText = totals[4];
  }


  document.querySelectorAll("#timesheetTable td[contenteditable='true']").forEach(cell => {
    cell.addEventListener("input", () => {
      saveData();
      calculateTotals();
    });
  });


  loadData();
  calculateTotals();
  </script>
</body>
</html>
